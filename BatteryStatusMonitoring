#include <stdio.h>
#include <string.h>
#include "BatteryStatusMonitoring.h"

char alertString[100] = "Alert: Battery Status: Out of Range: ";

int printWarningMessage(const char* statement) {
	printf("%s \n", statement);
	return 0;
}

int checkIfParameterWithinSpecifiedRange(float parameterValue, float lowerThreshold, float UpperThreshold) {
	if (parameterValue < lowerThreshold || parameterValue > UpperThreshold) {
		return 0;
	}
	return 1;
}

int limitBasedConditionCheck(float parameterValue, float max_limit) {
	if (parameterValue  > max_limit) {
		return 0;
	}
	return 1;
}

int checkStatusOfBattery(int status, const char* parameter) {
	if (status == 0) {
		strcat(ALERT_WARN_MSG, parameter);
		printWarningMessage(statement);
	}
	return status;
}

int checkBatteryTemperature(float temperature) {
	int status;
	status = rangeBasedConditionCheck(temperature, MIN_THRESHOLD_BATT_TEMP, MAX_THRESHOLD_BATT_TEMP);
	status = checkStatusOfBattery(status, "Temperature");
	return status;
}

int checkBatteryStateOfCharge(float stateOfCharge) {
	int status;
	status = checkIfParameterWithinSpecifiedRange(stateOfCharge, LOW_THRESHOLD_BATT_SOC, UPP_THRESHOLD_BATT_SOC);
	status = checkStatusOfBattery(status, "State of Charge");
	return status;
}

int checkBatteryChargeRate(float chargeRate){
	int status;
	status = limitBasedConditionCheck(chargeRate, MAX_THRESHOLD_BATT_CHARGE_RATE);
	status = checkStatusOfBattery(status, "Charge Rate");
	return status;
}

int checkBatteryCondition(float stateOfCharge, float temp, float chargeRate){
	int status;
	status =(checkBatteryTemperature(temp)) && (checkBatteryStateOfCharge(stateOfCharge)) && (checkBatteryChargeRate(chargeRate));
	return status;	
}
